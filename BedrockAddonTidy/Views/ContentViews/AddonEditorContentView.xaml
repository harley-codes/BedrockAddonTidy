<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
			 xmlns:vm="clr-namespace:BedrockAddonTidy.ViewModels"
			 xmlns:om="clr-namespace:BedrockAddonTidy.ObjectModels"
			 xmlns:cnv="clr-namespace:BedrockAddonTidy.Converters"
			 xmlns:sys="clr-namespace:System;assembly=mscorlib"
			 x:DataType="vm:AddonEditorViewModel"
			 x:Class="BedrockAddonTidy.Views.ContentViews.AddonEditorContentView">
	<ContentView.Resources>
		<ResourceDictionary>
			<cnv:ObjectNullableToBoolConverter x:Key="ObjectNullableToBoolConverter"/>
			<cnv:BoolInvertConverter x:Key="BoolInvertConverter"/>
			<cnv:StringEmptyToBoolConverter x:Key="StringEmptyToBoolConverter"/>
		</ResourceDictionary>
	</ContentView.Resources>
	<Border
		Margin="0,10,10,10"
		StrokeThickness="2"
		BackgroundColor="{StaticResource Gray900}"
		Opacity="0.8">
		<Grid Padding="0">
			<Grid IsVisible="{Binding SelectedAddon, Converter={StaticResource ObjectNullableToBoolConverter}, ConverterParameter=invert}">
				<Label
					Text="Select an Addon to edit"
					FontSize="24"
					FontFamily="MinecraftFive"
					HorizontalOptions="Center"
					VerticalOptions="Center"
					Margin="10"/>
			</Grid>
			<ScrollView IsVisible="{Binding SelectedAddon, Converter={StaticResource ObjectNullableToBoolConverter}}"
						Padding="10">
				<Grid RowDefinitions="Auto,Auto,*"
					  RowSpacing="10">
					<!-- Actions -->
					<Grid
						Grid.Row="0"
						ColumnDefinitions="Auto, *, Auto">
						<HorizontalStackLayout
							Grid.Column="0"
							Spacing="10">
							<Border Grid.Column="1"
									HeightRequest="58"
									StrokeShape="RoundRectangle 5"
									StrokeThickness="0">
								<Image Source="{Binding SelectedAddon.AddonFile.ImagePath}"/>
							</Border>
							<Button
								BackgroundColor="{StaticResource Gray600}"
								Text="Close"
								Command="{Binding DeselectAddonHandlerCommand}"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout
							Grid.Column="2"
							Spacing="10">
							<Button
								Text="Delete"
								BackgroundColor="Red"
								IsEnabled="{Binding DeleteAddonHandlerCommand.IsRunning, Converter={StaticResource BoolInvertConverter}, ConverterParameter=invert}"
								Command="{Binding DeleteAddonHandlerCommand}"/>
							<Button
								Text="Save"
								IsEnabled="{Binding SaveChangesHandlerCommand.IsRunning, Converter={StaticResource BoolInvertConverter}, ConverterParameter=invert}"
								Command="{Binding SaveChangesHandlerCommand}"/>
						</HorizontalStackLayout>
					</Grid>
					<!-- Errors and Warnings -->
					<CollectionView
						Grid.Row="1"
						ItemsSource="{Binding SelectedAddon.AddonWarnings}"
						SelectionMode="None">
						<CollectionView.ItemsLayout>
							<LinearItemsLayout Orientation="Vertical"
											   ItemSpacing="5"/>
						</CollectionView.ItemsLayout>
						<CollectionView.ItemTemplate>
							<DataTemplate x:DataType="sys:String">
								<Border
									Stroke="Red"
									StrokeThickness="3"
									Padding="5">
									<Label
										Text="{Binding .}"
										FontSize="22"
										HorizontalOptions="Center"
										VerticalOptions="Center"
										Margin="10"/>
								</Border>
							</DataTemplate>
						</CollectionView.ItemTemplate>
					</CollectionView>
					<!-- Editable Fields -->
					<VerticalStackLayout
						Grid.Row="2"
						Spacing="30">
						<Label
							Text="Base Settings"
							FontSize="24"
							TextColor="Green"
							FontFamily="MinecraftFive"
							Margin="0,0,0,10"/>
						<Label
							Text="Pack Name:"
							FontSize="22"
							FontFamily="MinecraftFive"/>
						<Border
							StrokeThickness="2"
							StrokeShape="Rectangle"
							BackgroundColor="Transparent"
							Padding="0">
							<Entry Text="{Binding SelectedAddon.AddonFile.Name}"
								   Visual="Default"
								   BackgroundColor="Transparent"
								   Margin="0"/>
						</Border>
						<Label
							Text="Description:"
							FontSize="22"
							FontFamily="MinecraftFive"/>
						<Border
							StrokeThickness="2"
							StrokeShape="Rectangle"
							BackgroundColor="Transparent"
							Padding="0">
							<Editor Text="{Binding SelectedAddon.AddonFile.Description}"
									Visual="Default"
									BackgroundColor="Transparent"
									Margin="0"
									AutoSize="TextChanges"/>
						</Border>
						<Label
							Text="Author:"
							FontSize="22"
							FontFamily="MinecraftFive"/>
						<Border
							StrokeThickness="2"
							StrokeShape="Rectangle"
							BackgroundColor="Transparent"
							Padding="0">
							<Editor Text="{Binding SelectedAddon.AddonFile.Author}"
									Visual="Default"
									BackgroundColor="Transparent"
									Margin="0"/>
						</Border>
						<!-- Resource Pack Settings -->
						<VerticalStackLayout
							Spacing="30"
							IsVisible="{Binding SelectedAddon.AddonFile.ResourcePackGuid, Converter={StaticResource StringEmptyToBoolConverter}}">
							<Label
								Text="Resource Pack Settings"
								FontSize="24"
								TextColor="Green"
								FontFamily="MinecraftFive"
								Margin="0,70,0,0"/>
							<VerticalStackLayout
								Spacing="10"
								IsVisible="{Binding SelectedAddon.AddonFile.ResourcePackNewFolderName, Converter={StaticResource StringEmptyToBoolConverter}}">
								<Label
									Text="Folder Name:"
									FontSize="22"
									FontFamily="MinecraftFive"/>
								<Border
									StrokeThickness="2"
									StrokeShape="Rectangle"
									BackgroundColor="Transparent"
									Padding="0">
									<Entry Text="{Binding SelectedAddon.AddonFile.ResourcePackNewFolderName}"
										   Visual="Default"
										   BackgroundColor="Transparent"
										   Margin="0"/>
								</Border>
							</VerticalStackLayout>
							<Grid ColumnDefinitions="Auto,*,65">
								<Label
									Grid.Column="0"
									Text="Use Dependency:"
									FontSize="22"
									FontFamily="MinecraftFive"/>
								<Switch
									Grid.Column="2"
									IsToggled="{Binding SelectedAddon.AddonFile.ResourcePackDependencyEnabled}"/>
							</Grid>
							<Grid
								ColumnSpacing="10"
								ColumnDefinitions="Auto,Auto,*,Auto">
								<Label
									Grid.Column="0"
									Text="Unique ID:"
									FontSize="22"
									FontFamily="MinecraftFive"
									VerticalOptions="Center"/>
								<Label
									Grid.Column="1"
									Text="{Binding SelectedAddon.AddonFile.ResourcePackGuid}"
									FontSize="22"
									VerticalOptions="Center"/>
								<Button
									Grid.Column="3"
									Text="New"
									Command="{Binding NewResourcePackGuidHandlerCommand}"
									IsEnabled="{Binding NewResourcePackGuidHandlerCommand.IsRunning, Converter={StaticResource BoolInvertConverter}, ConverterParameter=invert}"/>
							</Grid>
						</VerticalStackLayout>
						<!-- Behavior Pack Settings -->
						<VerticalStackLayout
							Spacing="30"
							IsVisible="{Binding SelectedAddon.AddonFile.BehaviorPackGuid, Converter={StaticResource StringEmptyToBoolConverter}}">
							<Label
								Text="Behavior Pack Settings"
								FontSize="24"
								TextColor="Green"
								FontFamily="MinecraftFive"
								Margin="0,70,0,0"/>
							<VerticalStackLayout
								Spacing="10"
								IsVisible="{Binding SelectedAddon.AddonFile.BehaviorPackNewFolderName, Converter={StaticResource StringEmptyToBoolConverter}}">
								<Label
									Text="Folder Name:"
									FontSize="22"
									FontFamily="MinecraftFive"/>
								<Border
									StrokeThickness="2"
									StrokeShape="Rectangle"
									BackgroundColor="Transparent"
									Padding="0">
									<Entry Text="{Binding SelectedAddon.AddonFile.BehaviorPackNewFolderName}"
										   Visual="Default"
										   BackgroundColor="Transparent"
										   Margin="0"/>
								</Border>
							</VerticalStackLayout>
							<Grid ColumnDefinitions="Auto,*,65">
								<Label
									Grid.Column="0"
									Text="Use Dependency:"
									FontSize="22"
									FontFamily="MinecraftFive"/>
								<Switch
									Grid.Column="2"
									IsToggled="{Binding SelectedAddon.AddonFile.BehaviorPackDependencyEnabled}"/>
							</Grid>
							<Grid
								ColumnSpacing="10"
								ColumnDefinitions="Auto,Auto,*,Auto">
								<Label
									Grid.Column="0"
									Text="Unique ID:"
									FontSize="22"
									FontFamily="MinecraftFive"
									VerticalOptions="Center"/>
								<Label
									Grid.Column="1"
									Text="{Binding SelectedAddon.AddonFile.BehaviorPackGuid}"
									FontSize="22"
									VerticalOptions="Center"/>
								<Button
									Grid.Column="3"
									HeightRequest="30"
									Text="New"
									Command="{Binding NewBehaviorPackGuidHandlerCommand}"
									IsEnabled="{Binding NewBehaviorPackGuidHandlerCommand.IsRunning, Converter={StaticResource BoolInvertConverter}, ConverterParameter=invert}"/>
							</Grid>
						</VerticalStackLayout>
					</VerticalStackLayout>
				</Grid>
			</ScrollView>
		</Grid>
	</Border>
</ContentView>
